<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>× ×™×”×•×œ ××œ××™ - ×¢×™×¦×•×‘ ×¦×™×¤×•×¨× ×™×™×</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
        }

        .login-box {
            background: white;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            max-width: 400px;
            margin: 100px auto;
        }

        .login-box h1 {
            color: #667eea;
            margin-bottom: 30px;
            text-align: center;
            font-size: 28px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: 600;
        }

        .form-group input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .form-group input:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn {
            width: 100%;
            padding: 15px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.5);
        }

        .admin-panel {
            display: none;
        }

        .header {
            background: white;
            padding: 25px;
            border-radius: 20px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            margin-bottom: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header h1 {
            color: #667eea;
            font-size: 28px;
        }

        .btn-logout {
            padding: 10px 20px;
            background: #ef4444;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            background: white;
            padding: 10px;
            border-radius: 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .tab {
            flex: 1;
            padding: 12px;
            background: #f5f5f5;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            color: #666;
            transition: all 0.3s;
        }

        .tab.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .section {
            background: white;
            padding: 25px;
            border-radius: 20px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .section h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 22px;
        }

        .add-item-form {
            display: grid;
            gap: 15px;
            margin-bottom: 30px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .color-picker-group {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .color-picker-group input[type="color"] {
            width: 60px;
            height: 45px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            cursor: pointer;
        }

        .image-upload-area {
            border: 3px dashed #667eea;
            border-radius: 15px;
            padding: 40px 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
        }

        .image-upload-area:hover {
            background: #f0f4ff;
            border-color: #764ba2;
        }

        .image-upload-area img {
            max-width: 200px;
            max-height: 200px;
            margin-top: 10px;
            border-radius: 10px;
        }

        .items-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
        }

        .item-card {
            background: #f9fafb;
            border-radius: 15px;
            padding: 15px;
            text-align: center;
            position: relative;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .item-card img {
            width: 100%;
            height: 150px;
            object-fit: cover;
            border-radius: 10px;
            margin-bottom: 10px;
        }

        .color-preview {
            width: 100%;
            height: 150px;
            border-radius: 10px;
            margin-bottom: 10px;
            border: 2px solid #e5e7eb;
        }

        .item-card h3 {
            color: #333;
            margin-bottom: 5px;
            font-size: 16px;
        }

        .item-card .price {
            color: #667eea;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .btn-delete {
            padding: 8px 15px;
            background: #ef4444;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            width: 100%;
        }

        .orders-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .order-card {
            background: #f9fafb;
            padding: 20px;
            border-radius: 15px;
            border-right: 4px solid #667eea;
        }

        .order-card.completed {
            opacity: 0.6;
            border-right-color: #10b981;
        }

        .order-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .order-date {
            color: #666;
            font-size: 14px;
        }

        .order-status {
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .order-status.pending {
            background: #fef3c7;
            color: #d97706;
        }

        .order-status.completed {
            background: #d1fae5;
            color: #059669;
        }

        .order-details {
            display: grid;
            gap: 10px;
        }

        .order-item {
            display: flex;
            justify-content: space-between;
            padding: 10px;
            background: white;
            border-radius: 8px;
        }

        .client-info {
            background: white;
            padding: 15px;
            border-radius: 10px;
            margin-top: 10px;
        }

        .btn-complete {
            margin-top: 10px;
            padding: 10px;
            background: #10b981;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            width: 100%;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
        }

        .stat-value {
            font-size: 36px;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 14px;
            opacity: 0.9;
        }

        .error-message {
            background: #fee2e2;
            color: #dc2626;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 15px;
            display: none;
        }

        .success-message {
            background: #d1fae5;
            color: #059669;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 15px;
            display: none;
        }

        .share-link {
            background: #f0f4ff;
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
        }

        .share-link input {
            width: 100%;
            padding: 10px;
            border: 2px solid #667eea;
            border-radius: 8px;
            font-family: monospace;
            margin-top: 10px;
        }

        .btn-copy {
            margin-top: 10px;
            padding: 10px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            width: 100%;
        }

        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .items-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            }
        }
    </style>
</head>
<body>
    <!-- Login Screen -->
    <div id="loginScreen" class="login-box">
        <h1>ğŸ” ×›× ×™×¡×ª ×‘×¢×œ×™×</h1>
        <div id="loginError" class="error-message"></div>
        <form id="loginForm" onsubmit="handleLogin(event)">
            <div class="form-group">
                <label>××™××™×™×œ:</label>
                <input type="email" id="loginEmail" required>
            </div>
            <div class="form-group">
                <label>×¡×™×¡××”:</label>
                <input type="password" id="loginPassword" required>
            </div>
            <button type="submit" class="btn btn-primary">×”×ª×—×‘×¨</button>
        </form>
    </div>

    <!-- Admin Panel -->
    <div id="adminPanel" class="admin-panel container">
        <div class="header">
            <h1>ğŸ¨ × ×™×”×•×œ ××œ××™ ×¢×™×¦×•×‘ ×¦×™×¤×•×¨× ×™×™×</h1>
            <button class="btn-logout" onclick="logout()">×”×ª× ×ª×§</button>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="switchTab('shapes')">ğŸ’… ×¦×•×¨×•×ª</button>
            <button class="tab" onclick="switchTab('colors')">ğŸ¨ ×¦×‘×¢×™×</button>
            <button class="tab" onclick="switchTab('orders')">ğŸ“‹ ×”×–×× ×•×ª</button>
            <button class="tab" onclick="switchTab('settings')">âš™ï¸ ×”×’×“×¨×•×ª</button>
        </div>

        <!-- Shapes Tab -->
        <div id="shapes-tab" class="tab-content active">
            <div class="section">
                <h2>×”×•×¡×¤×ª ×¦×•×¨×ª ×¦×™×¤×•×¨×Ÿ ×—×“×©×”</h2>
                <div id="shapeSuccess" class="success-message"></div>
                <form class="add-item-form" onsubmit="addShape(event)">
                    <div class="form-row">
                        <div class="form-group">
                            <label>×©× ×”×¦×•×¨×”:</label>
                            <input type="text" id="shapeName" placeholder="×œ×“×•×’××”: ××•×‘×œ×™×ª, ××¨×•×‘×¢×ª, ×©×§×“×™×ª" required>
                        </div>
                        <div class="form-group">
                            <label>××—×™×¨ (â‚ª):</label>
                            <input type="number" id="shapePrice" placeholder="0" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>×ª××•× ×ª ×”×¦×•×¨×”:</label>
                        <div class="image-upload-area" onclick="document.getElementById('shapeImage').click()">
                            <div style="font-size: 48px;">ğŸ“·</div>
                            <div>×œ×—×¥ ×œ×”×¢×œ××ª ×ª××•× ×”</div>
                            <img id="shapeImagePreview" style="display: none;">
                        </div>
                        <input type="file" id="shapeImage" accept="image/*" style="display: none;" onchange="previewImage(this, 'shapeImagePreview')">
                    </div>
                    <button type="submit" class="btn btn-primary">×”×•×¡×£ ×¦×•×¨×”</button>
                </form>
            </div>

            <div class="section">
                <h2>×¦×•×¨×•×ª ×–××™× ×•×ª</h2>
                <div id="shapesList" class="items-grid"></div>
            </div>
        </div>

        <!-- Colors Tab -->
        <div id="colors-tab" class="tab-content">
            <div class="section">
                <h2>×”×•×¡×¤×ª ×¦×‘×¢ ×—×“×©</h2>
                <div id="colorSuccess" class="success-message"></div>
                <form class="add-item-form" onsubmit="addColor(event)">
                    <div class="form-row">
                        <div class="form-group">
                            <label>×©× ×”×¦×‘×¢:</label>
                            <input type="text" id="colorName" placeholder="×œ×“×•×’××”: ×•×¨×•×“ ×¤×¡×˜×œ, ××“×•× ×™×™×Ÿ" required>
                        </div>
                        <div class="form-group">
                            <label>××—×™×¨ (â‚ª):</label>
                            <input type="number" id="colorPrice" placeholder="0" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>×‘×—×¨ ×¦×‘×¢:</label>
                        <div class="color-picker-group">
                            <input type="color" id="colorValue" value="#ff69b4">
                            <input type="text" id="colorHex" placeholder="#ff69b4" style="flex: 1;">
                        </div>
                    </div>
                    <button type="submit" class="btn btn-primary">×”×•×¡×£ ×¦×‘×¢</button>
                </form>
            </div>

            <div class="section">
                <h2>×¦×‘×¢×™× ×–××™× ×™×</h2>
                <div id="colorsList" class="items-grid"></div>
            </div>
        </div>

        <!-- Orders Tab -->
        <div id="orders-tab" class="tab-content">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value" id="pendingCount">0</div>
                    <div class="stat-label">×”×–×× ×•×ª ×××ª×™× ×•×ª</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="todayCount">0</div>
                    <div class="stat-label">×”×–×× ×•×ª ×”×™×•×</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="totalRevenue">â‚ª0</div>
                    <div class="stat-label">×¡×”"×› ×”×›× ×¡×•×ª</div>
                </div>
            </div>

            <div class="section">
                <h2>×”×–×× ×•×ª ×œ×§×•×—×•×ª</h2>
                <div id="ordersList" class="orders-list"></div>
            </div>
        </div>

        <!-- Settings Tab -->
        <div id="settings-tab" class="tab-content">
            <div class="section">
                <h2>×§×™×©×•×¨ ×œ×œ×§×•×—×•×ª</h2>
                <p style="margin-bottom: 15px; color: #666;">×©×ª×¤×™ ××ª ×”×§×™×©×•×¨ ×”×–×” ×¢× ×”×œ×§×•×—×•×ª ×©×œ×š:</p>
                <div class="share-link">
                    <input type="text" id="clientLink" readonly>
                    <button class="btn-copy" onclick="copyLink()">ğŸ“‹ ×”×¢×ª×§ ×§×™×©×•×¨</button>
                </div>
            </div>

            <div class="section">
                <h2>×©×™× ×•×™ ×¡×™×¡××”</h2>
                <div id="passwordSuccess" class="success-message"></div>
                <form class="add-item-form" onsubmit="changePassword(event)">
                    <div class="form-group">
                        <label>×¡×™×¡××” ×—×“×©×”:</label>
                        <input type="password" id="newPassword" minlength="6" required>
                    </div>
                    <div class="form-group">
                        <label>××™××•×ª ×¡×™×¡××”:</label>
                        <input type="password" id="confirmPassword" minlength="6" required>
                    </div>
                    <button type="submit" class="btn btn-primary">×©× ×” ×¡×™×¡××”</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getAuth, signInWithEmailAndPassword, signOut, onAuthStateChanged, updatePassword } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
        import { getDatabase, ref, set, push, onValue, remove, update } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js';
        import { getStorage, ref as storageRef, uploadBytes, getDownloadURL } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-storage.js';

        // TODO: Replace with your Firebase config
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
            databaseURL: "https://YOUR_PROJECT_ID-default-rtdb.firebaseio.com",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_PROJECT_ID.appspot.com",
            messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
            appId: "YOUR_APP_ID"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getDatabase(app);
        const storage = getStorage(app);

        // Make functions global
        window.auth = auth;
        window.db = db;
        window.storage = storage;
        window.dbRef = ref;
        window.dbSet = set;
        window.dbPush = push;
        window.dbOnValue = onValue;
        window.dbRemove = remove;
        window.dbUpdate = update;
        window.storageRef = storageRef;
        window.uploadBytes = uploadBytes;
        window.getDownloadURL = getDownloadURL;
        window.signInWithEmailAndPassword = signInWithEmailAndPassword;
        window.signOut = signOut;
        window.updatePassword = updatePassword;

        // Auth state listener
        onAuthStateChanged(auth, (user) => {
            if (user) {
                document.getElementById('loginScreen').style.display = 'none';
                document.getElementById('adminPanel').style.display = 'block';
                loadData();
                setupClientLink();
            } else {
                document.getElementById('loginScreen').style.display = 'block';
                document.getElementById('adminPanel').style.display = 'none';
            }
        });
    </script>

    <script>
        function switchTab(tabName) {
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tabName + '-tab').classList.add('active');
        }

        function handleLogin(event) {
            event.preventDefault();
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            signInWithEmailAndPassword(auth, email, password)
                .catch((error) => {
                    const errorMsg = document.getElementById('loginError');
                    errorMsg.textContent = '××™××™×™×œ ××• ×¡×™×¡××” ×©×’×•×™×™×';
                    errorMsg.style.display = 'block';
                });
        }

        function logout() {
            signOut(auth);
        }

        function previewImage(input, previewId) {
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const preview = document.getElementById(previewId);
                    preview.src = e.target.result;
                    preview.style.display = 'block';
                };
                reader.readAsDataURL(input.files[0]);
            }
        }

        async function addShape(event) {
            event.preventDefault();
            
            const name = document.getElementById('shapeName').value;
            const price = document.getElementById('shapePrice').value;
            const imageFile = document.getElementById('shapeImage').files[0];
            
            if (!imageFile) {
                alert('×× × ×‘×—×¨ ×ª××•× ×”');
                return;
            }

            try {
                // Upload image
                const imageRef = storageRef(storage, `shapes/${Date.now()}_${imageFile.name}`);
                await uploadBytes(imageRef, imageFile);
                const imageUrl = await getDownloadURL(imageRef);

                // Save to database
                const shapesRef = dbRef(db, 'shapes');
                await dbPush(shapesRef, {
                    name,
                    price: parseInt(price),
                    imageUrl,
                    createdAt: Date.now()
                });

                // Reset form
                event.target.reset();
                document.getElementById('shapeImagePreview').style.display = 'none';
                
                showSuccess('shapeSuccess', '×”×¦×•×¨×” × ×•×¡×¤×” ×‘×”×¦×œ×—×”!');
            } catch (error) {
                alert('×©×’×™××” ×‘×”×•×¡×¤×ª ×”×¦×•×¨×”: ' + error.message);
            }
        }

        async function addColor(event) {
            event.preventDefault();
            
            const name = document.getElementById('colorName').value;
            const price = document.getElementById('colorPrice').value;
            const color = document.getElementById('colorValue').value;

            try {
                const colorsRef = dbRef(db, 'colors');
                await dbPush(colorsRef, {
                    name,
                    price: parseInt(price),
                    color,
                    createdAt: Date.now()
                });

                event.target.reset();
                showSuccess('colorSuccess', '×”×¦×‘×¢ × ×•×¡×£ ×‘×”×¦×œ×—×”!');
            } catch (error) {
                alert('×©×’×™××” ×‘×”×•×¡×¤×ª ×”×¦×‘×¢: ' + error.message);
            }
        }

        function loadData() {
            // Load shapes
            const shapesRef = dbRef(db, 'shapes');
            dbOnValue(shapesRef, (snapshot) => {
                const shapes = snapshot.val();
                renderShapes(shapes);
            });

            // Load colors
            const colorsRef = dbRef(db, 'colors');
            dbOnValue(colorsRef, (snapshot) => {
                const colors = snapshot.val();
                renderColors(colors);
            });

            // Load orders
            const ordersRef = dbRef(db, 'orders');
            dbOnValue(ordersRef, (snapshot) => {
                const orders = snapshot.val();
                renderOrders(orders);
                updateStats(orders);
            });
        }

        function renderShapes(shapes) {
            const container = document.getElementById('shapesList');
            container.innerHTML = '';
            
            if (!shapes) {
                container.innerHTML = '<div style="text-align: center; color: #999; padding: 40px;">××™×Ÿ ×¦×•×¨×•×ª ×¢×“×™×™×Ÿ</div>';
                return;
            }

            Object.entries(shapes).forEach(([id, shape]) => {
                const card = document.createElement('div');
                card.className = 'item-card';
                card.innerHTML = `
                    <img src="${shape.imageUrl}" alt="${shape.name}">
                    <h3>${shape.name}</h3>
                    <div class="price">â‚ª${shape.price}</div>
                    <button class="btn-delete" onclick="deleteItem('shapes', '${id}')">××—×§</button>
                `;
                container.appendChild(card);
            });
        }

        function renderColors(colors) {
            const container = document.getElementById('colorsList');
            container.innerHTML = '';
            
            if (!colors) {
                container.innerHTML = '<div style="text-align: center; color: #999; padding: 40px;">××™×Ÿ ×¦×‘×¢×™× ×¢×“×™×™×Ÿ</div>';
                return;
            }

            Object.entries(colors).forEach(([id, color]) => {
                const card = document.createElement('div');
                card.className = 'item-card';
                card.innerHTML = `
                    <div class="color-preview" style="background: ${color.color};"></div>
                    <h3>${color.name}</h3>
                    <div class="price">â‚ª${color.price}</div>
                    <button class="btn-delete" onclick="deleteItem('colors', '${id}')">××—×§</button>
                `;
                container.appendChild(card);
            });
        }

        function renderOrders(orders) {
            const container = document.getElementById('ordersList');
            container.innerHTML = '';
            
            if (!orders) {
                container.innerHTML = '<div style="text-align: center; color: #999; padding: 40px;">××™×Ÿ ×”×–×× ×•×ª ×¢×“×™×™×Ÿ</div>';
                return;
            }

            const ordersArray = Object.entries(orders).sort((a, b) => b[1].createdAt - a[1].createdAt);
            
            ordersArray.forEach(([id, order]) => {
                const card = document.createElement('div');
                card.className = `order-card ${order.status}`;
                
                const date = new Date(order.createdAt).toLocaleString('he-IL');
                const total = (order.shape.price + order.color.price);
                
                card.innerHTML = `
                    <div class="order-header">
                        <div class="order-date">ğŸ“… ${date}</div>
                        <div class="order-status ${order.status}">
                            ${order.status === 'pending' ? 'â³ ×××ª×™×Ÿ' : 'âœ… ×”×•×©×œ×'}
                        </div>
                    </div>
                    <div class="client-info">
                        <strong>ğŸ‘¤ ${order.clientName}</strong><br>
                        <span style="color: #666;">ğŸ“± ${order.clientPhone}</span>
                    </div>
                    <div class="order-details">
                        <div class="order-item">
                            <span>ğŸ’… ${order.shape.name}</span>
                            <span>â‚ª${order.shape.price}</span>
                        </div>
                        <div class="order-item">
                            <span>ğŸ¨ ${order.color.name}</span>
                            <span>â‚ª${order.color.price}</span>
                        </div>
                        <div class="order-item" style="font-weight: 600; background: #f0f4ff;">
                            <span>×¡×”"×›</span>
                            <span>â‚ª${total}</span>
                        </div>
                    </div>
                    ${order.status === 'pending' ? `
                        <button class="btn-complete" onclick="completeOrder('${id}')">×¡××Ÿ ×›×”×•×©×œ×</button>
                    ` : ''}
                `;
                container.appendChild(card);
            });
        }

        function updateStats(orders) {
            if (!orders) {
                document.getElementById('pendingCount').textContent = '0';
                document.getElementById('todayCount').textContent = '0';
                document.getElementById('totalRevenue').textContent = 'â‚ª0';
                return;
            }

            const ordersArray = Object.values(orders);
            const pending = ordersArray.filter(o => o.status === 'pending').length;
            
            const today = new Date().setHours(0, 0, 0, 0);
            const todayOrders = ordersArray.filter(o => new Date(o.createdAt).setHours(0, 0, 0, 0) === today).length;
            
            const revenue = ordersArray.reduce((sum, o) => sum + o.shape.price + o.color.price, 0);

            document.getElementById('pendingCount').textContent = pending;
            document.getElementById('todayCount').textContent = todayOrders;
            document.getElementById('totalRevenue').textContent = 'â‚ª' + revenue;
        }

        async function deleteItem(type, id) {
            if (confirm('×”×× ×œ××—×•×§ ×¤×¨×™×˜ ×–×”?')) {
                try {
                    await dbRemove(dbRef(db, `${type}/${id}`));
                } catch (error) {
                    alert('×©×’×™××” ×‘××—×™×§×”: ' + error.message);
                }
            }
        }

        async function completeOrder(orderId) {
            try {
                await dbUpdate(dbRef(db, `orders/${orderId}`), {
                    status: 'completed'
                });
            } catch (error) {
                alert('×©×’×™××” ×‘×¢×“×›×•×Ÿ ×”×”×–×× ×”: ' + error.message);
            }
        }

        function setupClientLink() {
            const link = window.location.origin + '/client.html';
            document.getElementById('clientLink').value = link;
        }

        function copyLink() {
            const input = document.getElementById('clientLink');
            input.select();
            document.execCommand('copy');
            alert('×”×§×™×©×•×¨ ×”×•×¢×ª×§! ğŸ“‹');
        }

        async function changePassword(event) {
            event.preventDefault();
            
            const newPass = document.getElementById('newPassword').value;
            const confirmPass = document.getElementById('confirmPassword').value;
            
            if (newPass !== confirmPass) {
                alert('×”×¡×™×¡×××•×ª ××™× ×Ÿ ×ª×•×××•×ª');
                return;
            }

            try {
                await updatePassword(auth.currentUser, newPass);
                event.target.reset();
                showSuccess('passwordSuccess', '×”×¡×™×¡××” ×©×•× ×ª×” ×‘×”×¦×œ×—×”!');
            } catch (error) {
                alert('×©×’×™××” ×‘×©×™× ×•×™ ×”×¡×™×¡××”: ' + error.message);
            }
        }

        function showSuccess(id, message) {
            const element = document.getElementById(id);
            element.textContent = message;
            element.style.display = 'block';
            setTimeout(() => {
                element.style.display = 'none';
            }, 3000);
        }

        // Color picker sync
        document.addEventListener('DOMContentLoaded', () => {
            const colorPicker = document.getElementById('colorValue');
            const colorHex = document.getElementById('colorHex');
            
            if (colorPicker && colorHex) {
                colorPicker.addEventListener('input', (e) => {
                    colorHex.value = e.target.value;
                });
                
                colorHex.addEventListener('input', (e) => {
                    if (/^#[0-9A-F]{6}$/i.test(e.target.value)) {
                        colorPicker.value = e.target.value;
                    }
                });
            }
        });
    </script>
</body>
</html>
